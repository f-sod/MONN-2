Original updated codes from https://github.com/lishuya17/MONN/tree/master/src
